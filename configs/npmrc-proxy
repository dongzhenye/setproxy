#!/bin/bash
# npm ä»£ç†é…ç½®
# ä½¿ç”¨æ–¹æ³•: 
# 1. å¼€å¯ä»£ç†: bash configs/npmrc-proxy on
# 2. å…³é—­ä»£ç†: bash configs/npmrc-proxy off

# åŠ è½½é€šç”¨å‡½æ•°
source "$(dirname "${BASH_SOURCE[0]}")/common.sh"
PROXY_URL="$(get_proxy_url)"

# æ£€æŸ¥å‚æ•°
if [ "$1" == "on" ]; then
    echo "ğŸ“¦ é…ç½®npmä»£ç†..."
    npm config set proxy $PROXY_URL
    npm config set https-proxy $PROXY_URL
    npm config set registry https://registry.npmjs.org/
    echo "âœ… npmä»£ç†å·²å¼€å¯"
    echo "HTTPä»£ç†: $(npm config get proxy)"
    echo "HTTPSä»£ç†: $(npm config get https-proxy)"
    echo "Registry: $(npm config get registry)"
elif [ "$1" == "off" ]; then
    echo "ğŸ“¦ ç§»é™¤npmä»£ç†..."
    npm config delete proxy
    npm config delete https-proxy
    echo "ğŸ”´ npmä»£ç†å·²å…³é—­"
else
    echo "ä½¿ç”¨æ–¹æ³•:"
    echo "  å¼€å¯ä»£ç†: bash configs/npmrc-proxy on"
    echo "  å…³é—­ä»£ç†: bash configs/npmrc-proxy off"
    echo ""
    echo "å½“å‰é…ç½®:"
    echo "  HTTPä»£ç†: $(npm config get proxy || echo 'æœªè®¾ç½®')"
    echo "  HTTPSä»£ç†: $(npm config get https-proxy || echo 'æœªè®¾ç½®')"
    echo "  Registry: $(npm config get registry)"
fi 