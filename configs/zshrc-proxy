# macOS ç»ˆç«¯ä»£ç†é…ç½®
# å°†æ­¤å†…å®¹æ·»åŠ åˆ° ~/.zshrc æ–‡ä»¶ä¸­

# ä»£ç†æœåŠ¡å™¨é…ç½®
PROXY_HOST="127.0.0.1"
PROXY_PORT="7890"
PROXY_URL="http://${PROXY_HOST}:${PROXY_PORT}"

# ä»£ç†å¿«æ·å‘½ä»¤
alias proxy-on='export HTTP_PROXY="${PROXY_URL}" && export HTTPS_PROXY="${PROXY_URL}" && export ALL_PROXY="${PROXY_URL}" && export http_proxy="${PROXY_URL}" && export https_proxy="${PROXY_URL}" && export all_proxy="${PROXY_URL}" && export NO_PROXY="localhost,127.0.0.1,::1,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,100.64.0.0/10,17.0.0.0/8,169.254.0.0/16,224.0.0.0/4,240.0.0.0/4" && export no_proxy="${NO_PROXY}" && echo "âœ… ä»£ç†å·²å¼€å¯"'

alias proxy-off='unset HTTP_PROXY && unset HTTPS_PROXY && unset ALL_PROXY && unset http_proxy && unset https_proxy && unset all_proxy && unset NO_PROXY && unset no_proxy && echo "ðŸ”´ ä»£ç†å·²å…³é—­"'

alias proxy-status='echo "HTTP_PROXY: ${HTTP_PROXY:-æœªè®¾ç½®}" && echo "HTTPS_PROXY: ${HTTPS_PROXY:-æœªè®¾ç½®}" && echo "ALL_PROXY: ${ALL_PROXY:-æœªè®¾ç½®}"'

# æ£€æŸ¥ä»£ç†è¿žæŽ¥çš„å‡½æ•°
proxy-test() {
    if command -v curl > /dev/null; then
        echo "æµ‹è¯•Googleè¿žæŽ¥..."
        curl -I --connect-timeout 5 https://google.com
    else
        echo "curlå‘½ä»¤ä¸å¯ç”¨"
    fi
}

# æ™ºèƒ½ä»£ç†ï¼šæ£€æŸ¥Clashæ˜¯å¦è¿è¡Œï¼Œå¦‚æžœè¿è¡Œåˆ™è‡ªåŠ¨å¼€å¯ä»£ç†
# å–æ¶ˆæ³¨é‡Šä¸‹é¢çš„è¡Œæ¥å¯ç”¨è‡ªåŠ¨ä»£ç†
# if lsof -i :7890 > /dev/null 2>&1; then
#     proxy-on > /dev/null 2>&1
# fi 